// src/App.js
import React, { useState, useEffect } from "react";
import { initializeApp } from "firebase/app";
import { getDatabase, ref, set, push, onValue, update } from "firebase/database";

// Configura√ß√£o Firebase
const firebaseConfig = {
  apiKey: "AIzaSyD1LRhrVBA5T2qfunpg8bTXlA5Z58-RL6M",
  authDomain: "lista-de-itens-em-falta.firebaseapp.com",
  databaseURL: "https://lista-de-itens-em-falta-default-rtdb.firebaseio.com",
  projectId: "lista-de-itens-em-falta",
  storageBucket: "lista-de-itens-em-falta.firebasestorage.app",
  messagingSenderId: "178769313308",
  appId: "1:178769313308:web:cdb4cdc520f8eeb23729d9",
  measurementId: "G-MTRHXEFMP8"
};

// Inicializa Firebase
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

export default function App() {
  const [items, setItems] = useState([]);
  const [text, setText] = useState("");
  const [isCheckbox, setIsCheckbox] = useState(false);
  const [fontSize, setFontSize] = useState(18);

  // Carregar lista do Firebase
  useEffect(() => {
    const itemsRef = ref(db, "lista");
    onValue(itemsRef, (snapshot) => {
      const data = snapshot.val();
      if (data) {
        setItems(Object.values(data));
      } else {
        setItems([]);
      }
    });
  }, []);

  // Adicionar item
  const addItem = () => {
    if (!text.trim()) return;
    const newItem = {
      id: Date.now(),
      text,
      isCheckbox,
      checked: false,
      fontSize,
    };
    const newRef = push(ref(db, "lista"));
    set(newRef, newItem);
    setText("");
  };

  // Alternar check
  const toggleCheck = (itemId, checked) => {
    const itemRef = ref(db, "lista/" + itemId);
    update(itemRef, { checked: !checked });
  };

  return (
    <div style={{ padding: 20, background: "#f9f9f9", minHeight: "100vh" }}>
      <h2>üìù Lista de Compras</h2>

      {/* Entrada de texto */}
      <input
        type="text"
        placeholder="Digite um item ou descri√ß√£o..."
        value={text}
        onChange={(e) => setText(e.target.value)}
        style={{ padding: 8, width: "80%", fontSize: 16 }}
      />
      <button onClick={addItem} style={{ marginLeft: 10, padding: 8 }}>
        Adicionar
      </button>

      {/* Op√ß√£o normal/checkbox */}
      <div style={{ marginTop: 10 }}>
        <label>
          <input
            type="checkbox"
            checked={isCheckbox}
            onChange={(e) => setIsCheckbox(e.target.checked)}
          />{" "}
          Criar com caixinha
        </label>
      </div>

      {/* Controle de fonte */}
      <div style={{ marginTop: 10 }}>
        <label>Tamanho da fonte: </label>
        <input
          type="number"
          value={fontSize}
          onChange={(e) => setFontSize(Number(e.target.value))}
          style={{ width: 60 }}
        />
      </div>

      {/* Lista de itens */}
      <ul style={{ marginTop: 20, listStyle: "none", padding: 0 }}>
        {items.map((item) => (
          <li key={item.id} style={{ fontSize: item.fontSize, marginBottom: 8 }}>
            {item.isCheckbox ? (
              <label>
                <input
                  type="checkbox"
                  checked={item.checked}
                  onChange={() => toggleCheck(item.id, item.checked)}
                />{" "}
                {item.text}
              </label>
            ) : (
              <span>{item.text}</span>
            )}
          </li>
        ))}
      </ul>
    </div>
  );
}
